<?xml version="1.0" encoding="UTF-8"?>

<!-- ==== #29. mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- ==== #29. 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<!-- ==== 대부분은 namespace에 파일이름 사용(유일하니까) ==== -->
<mapper namespace="hwanmo">

	<select id="idDuplicateCheck" parameterType="String" resultType="boolean">
  		select count(*)
		from tbl_employees
		where pk_emp_no = #{pk_emp_no}
	</select>
	
	<select id="emailDuplicateCheck" parameterType="String" resultType="boolean">
  		select count(*)
		from tbl_employees
		where uq_email = #{uq_email}
	</select>
	
	<insert id="registerMember" parameterType="com.spring.bts.hwanmo.model.EmployeeVO" >
	
	insert into tbl_employees 
	(pk_emp_no, fk_department_id, fk_rank_id, fk_board_authority_no, fk_site_authority_no, emp_name, emp_pwd, com_tel, postal, address, detailaddress, extraaddress
	, gender, uq_phone, uq_email, img_path, img_name, birthday, gradelevel)
	values                                  
	(#{pk_emp_no}, #{fk_department_id}, #{fk_rank_id}, default, default, #{emp_name}, #{emp_pwd}, #{com_tel}, #{postal}, #{address}, #{detailaddress}, #{extraaddress}
	, #{gender}, #{uq_phone}, #{uq_email}, default, default, #{birthday}, default)
	
	
	</insert>
	
	<select id="findEmpNo" parameterType="HashMap" resultType="String">
	select pk_emp_no
	from tbl_employees
	where ishired = 1
	and emp_name = #{emp_name} and uq_email = #{uq_email}
	
	</select>

	<select id="isUserExist" parameterType="HashMap" resultType="String">
	select pk_emp_no
	from tbl_employees
	where ishired = 1
	and pk_emp_no = #{pk_emp_no} and uq_email = #{uq_email}
	
	</select>
	
	<update id="pwdUpdate" parameterType="HashMap">
		update tbl_employees set emp_pwd = #{emp_pwd}, lastpwdchangedate = sysdate
		where pk_emp_no = #{pk_emp_no}
	</update>
	
	<!-- 왜이러는거야~~ -->
	
</mapper>